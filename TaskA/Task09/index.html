<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            width: 100%;
            height: 100vh;
        }
    </style>
</head>

<body>
    <main>
        <textarea name="" id="textarea" cols="30" rows="10"></textarea>
        <section></section>
    </main>
    <script>
        const textarea = document.querySelector('textarea')
        const section = document.querySelector('section')

        const parseNewLine = async (text) => text.replace(/\n/gm, "<br>");
        const parseTitlte = async (text) => {
            const matched = text.matchAll(/(#{1,6})\s(\w+)(<br>)?/gm);
            for (let match of matched) {
                text = text.replace(match[0], `<h${match[1].length}>${match[2]}</h${match[1].length}>`)
            }
            return text;
        }
        const parseBolder = async (text) => {
            const matched = text.matchAll(/\*\*(\w+)\*\*/gm);
            for (let match of matched) {
                text = text.replace(match[0], `<b>${match[1]}</b>`)
            }
            return text;
        }

        const parseHr = async (text) => text.replace(/---/gm, '<hr>');

        const parseLi = async (text) => {
            const matched = text.matchAll(/-\s(\w+)(<br>)?/gm);
            for (let match of matched) {
                text = text.replace(match[0], `<li>${match[1]}</li>`)
            }
            return text;
        }

        const parseImg = async (text) => {
            const matched = text.matchAll(/\!\[(\w\S+)?\]\((\w\S+)?\)/gm);
            for (let match of matched) {
                text = text.replace(match[0], `<img src='${match[2]}' alt='${match[1]}'>`)
            }
            return text;
        }
        const parseLink = async (text) => {
            const matched = text.matchAll(/\[(\w\S+)\]\((\w\S+)\)/gm);
            for (let match of matched) {
                text = text.replace(match[0], `<a href='${match[2]}'>${match[1]}</a>`)
            }
            return text;
        }

        textarea.addEventListener('input', async (e) => {
            const value = e.target.value;
            let syntax = await parseNewLine(value)
                .then(parseTitlte)
                .then(parseBolder)
                .then(parseHr)
                .then(parseLi)
                .then(parseImg)
                .then(parseLink)

            section.innerHTML = syntax;
        })
    </script>
</body>

</html>